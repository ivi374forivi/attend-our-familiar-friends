<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Pawsitive Dog Care Schedule</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Lato:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #FFF8F5; /* Soft peach cream */
            --text-color: #4B423F; /* Dark taupe */
            --primary-accent: #D4A5A5; /* Dusty rose */
            --secondary-accent: #A5B4D4; /* Periwinkle blue */
            --highlight-color: #E8C3A0; /* Warm sand */
            --card-bg: #FFFFFF;
            --border-color: #EAE0DC;
        }
        body {
            font-family: 'Lato', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
        }
        .title-font {
            font-family: 'Playfair Display', serif;
        }
        /* Animal Print Backgrounds (Subtle SVGs) */
        .skin-leopard {
            background-color: #F8E8E8; /* Light pink */
            background-image: url("data:image/svg+xml,%3Csvg width='20' height='20' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='%23D4A5A5' fill-opacity='0.4' fill-rule='evenodd'%3E%3Ccircle cx='3' cy='3' r='3'/%3E%3Ccircle cx='13' cy='13' r='3'/%3E%3C/g%3E%3C/svg%3E");
        }
        .skin-giraffe {
            background-color: #FFF4E0; /* Light peach */
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='40' viewBox='0 0 40 40'%3E%3Cg fill-rule='evenodd'%3E%3Cg fill='%23E8C3A0' fill-opacity='0.5'%3E%3Cpath d='M0 38.59l2.83-2.83 1.41 1.41L1.41 40H0v-1.41zM0 1.4l2.83 2.83 1.41-1.41L1.41 0H0v1.41zM38.59 40l-2.83-2.83 1.41-1.41L40 38.59V40h-1.41zM40 1.41l-2.83 2.83-1.41-1.41L38.59 0H40v1.41zM20 18.6l2.83-2.83 1.41 1.41L21.41 20l2.83 2.83-1.41 1.41L20 21.41l-2.83 2.83-1.41-1.41L18.59 20l-2.83-2.83 1.41-1.41L20 18.59z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        }
        .skin-zebra {
            background-color: #E9E7F4; /* Light lavender */
            background-image: url("data:image/svg+xml,%3Csvg width='52' height='26' viewBox='0 0 52 26' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23A5B4D4' fill-opacity='0.4'%3E%3Cpath d='M10 10c0-2.21-1.79-4-4-4-3.314 0-6-2.686-6-6h2c0 2.21 1.79 4 4 4 3.314 0 6 2.686 6 6 0 2.21 1.79 4 4 4 3.314 0 6 2.686 6 6 0 2.21 1.79 4 4 4v2c-3.314 0-6-2.686-6-6 0-2.21-1.79-4-4-4-3.314 0-6-2.686-6-6zm25.464-1.95l8.486 8.486-1.414 1.414-8.486-8.486 1.414-1.414z' /%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        }
        .skin-dots {
            background-color: #E0F2F1; /* Light teal */
            background-image: url("data:image/svg+xml,%3Csvg width='6' height='6' viewBox='0 0 6 6' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='%2380CBC4' fill-opacity='0.5' fill-rule='evenodd'%3E%3Cpath d='M5 0h1L0 6V5zM6 5v1H5z'/%3E%3C/g%3E%3C/svg%3E");
        }
        .task-list {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.7s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .task-list.expanded {
            max-height: 1500px;
        }
        .task-item.completed {
            opacity: 0.6;
        }
        .task-item.completed .task-text {
            text-decoration: line-through;
            text-decoration-color: var(--primary-accent);
        }
        .task-item.completed .check-circle {
            background-color: var(--primary-accent);
            border-color: var(--primary-accent);
        }
        .task-item.completed .check-circle svg {
            transform: scale(1);
        }
        .check-circle svg {
            transform: scale(0);
            transition: transform 0.2s ease-in-out;
        }
        .rotate-180 {
            transform: rotate(180deg);
        }
        .transition-transform {
            transition: transform 0.3s ease-in-out;
        }
        .modal {
            transition: opacity 0.3s ease;
        }
        .modal-content {
            transition: transform 0.3s ease;
        }
    </style>
</head>
<body class="min-h-screen p-4 sm:p-6 lg:p-8">

    <div class="max-w-3xl mx-auto">
        <header class="text-center mb-8">
            <h1 class="title-font text-4xl sm:text-5xl" style="color: var(--primary-accent);">Daily Dog Care</h1>
            <p class="text-lg mt-2" style="color: var(--text-color);">A pawsitive schedule for our beloved pack</p>
        </header>

        <!-- AI Feature Button -->
        <div class="text-center mb-8">
            <button id="ai-button" class="bg-rose-500 hover:bg-rose-600 text-white font-bold py-3 px-6 rounded-full shadow-lg transform hover:scale-105 transition-all duration-300 ease-in-out flex items-center justify-center mx-auto">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2 h-5 w-5"><path d="M12 2a10 10 0 0 0-4.37 18.25c.37.07.51-.16.51-.35 0-.17-.01-1.04-.01-1.9-3.75.81-4.54-1.6-4.54-1.6-.34-.86-.82-1.09-.82-1.09-.67-.46.05-.45.05-.45.74.05 1.13.76 1.13.76.66 1.12 1.73.8 2.15.61.07-.48.26-.8.48-1 .01 0-3.29-.35-3.29-7.31 0-1.62.58-2.94 1.53-3.98-.15-.36-.66-1.88.15-3.92 0 0 1.24-.4 4.07 1.52a14.27 14.27 0 0 1 3.7-.5c1.26.02 2.52.17 3.7.5 2.83-1.92 4.07-1.52 4.07-1.52.81 2.04.3 3.56.15 3.92.95 1.04 1.53 2.36 1.53 3.98 0 3.97-3.29 7.3-3.29 7.3.22.2.48.6.48 1.21 0 .88-.01 1.58-.01 1.8 0 .19.14.42.51.35A10 10 0 0 0 12 2z"></path></svg>
                Generate Daily Pawsitive Report
            </button>
        </div>

        <!-- Timeline -->
        <div class="space-y-4">
            <!-- 9:00 AM -->
            <div class="bg-white rounded-xl shadow-md overflow-hidden border border-gray-200">
                <div class="p-4 sm:p-5 accordion-header cursor-pointer flex justify-between items-center skin-leopard transition-colors">
                    <div class="flex items-center">
                        <div class="bg-white/70 rounded-lg p-3 mr-4 backdrop-blur-sm"><h2 class="font-bold text-lg sm:text-xl" style="color: var(--primary-accent);">9:00 AM</h2></div>
                        <div><p class="font-semibold">Morning Routine</p></div>
                    </div>
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-6 w-6 accordion-arrow transition-transform"><path d="m6 9 6 6 6-6"></path></svg>
                </div>
                <div class="task-list"><div class="p-4 sm:p-5 border-t" style="border-color: var(--border-color);"><ul class="space-y-3">
                    <li class="flex items-start cursor-pointer task-item group"><div class="check-circle shrink-0 h-5 w-5 rounded-full border-2 mr-3 mt-1 flex items-center justify-center transition-colors" style="border-color: var(--primary-accent);"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M20 6 9 17l-5-5"></path></svg></div><span class="task-text transition-all">Little girls out & doggie door panel removed.</span></li>
                    <li class="flex items-start cursor-pointer task-item group"><div class="check-circle shrink-0 h-5 w-5 rounded-full border-2 mr-3 mt-1 flex items-center justify-center transition-colors" style="border-color: var(--primary-accent);"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M20 6 9 17l-5-5"></path></svg></div><span class="task-text transition-all">Coax Gracey from crate. <b class="font-bold text-red-500">Must carry her on stairs.</b></span></li>
                    <li class="flex items-start cursor-pointer task-item group"><div class="check-circle shrink-0 h-5 w-5 rounded-full border-2 mr-3 mt-1 flex items-center justify-center transition-colors" style="border-color: var(--primary-accent);"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M20 6 9 17l-5-5"></path></svg></div><span class="task-text transition-all">Gracey's medicine in wheel <b class="font-bold">right before</b> she eats.</span></li>
                    <li class="flex items-start cursor-pointer task-item group"><div class="check-circle shrink-0 h-5 w-5 rounded-full border-2 mr-3 mt-1 flex items-center justify-center transition-colors" style="border-color: var(--primary-accent);"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M20 6 9 17l-5-5"></path></svg></div><span class="task-text transition-all">Big girls: 1 probiotic (pink bottle) & 1 tablet (glass jar).</span></li>
                    <li class="flex items-start cursor-pointer task-item group"><div class="check-circle shrink-0 h-5 w-5 rounded-full border-2 mr-3 mt-1 flex items-center justify-center transition-colors" style="border-color: var(--primary-accent);"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M20 6 9 17l-5-5"></path></svg></div><span class="task-text transition-all">Let big girls out. <b class="font-bold text-orange-600">Watch Macy P (15-min crate rule).</b></span></li>
                    <li class="flex items-start cursor-pointer task-item group"><div class="check-circle shrink-0 h-5 w-5 rounded-full border-2 mr-3 mt-1 flex items-center justify-center transition-colors" style="border-color: var(--primary-accent);"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M20 6 9 17l-5-5"></path></svg></div><span class="task-text transition-all">Feed big girls & ensure they eat from their bowls.</span></li>
                    <li class="flex items-start cursor-pointer task-item group"><div class="check-circle shrink-0 h-5 w-5 rounded-full border-2 mr-3 mt-1 flex items-center justify-center transition-colors" style="border-color: var(--primary-accent);"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M20 6 9 17l-5-5"></path></svg></div><span class="task-text transition-all">Wash water bottles & check bathroom bowl.</span></li>
                    <li class="flex items-start cursor-pointer task-item group"><div class="check-circle shrink-0 h-5 w-5 rounded-full border-2 mr-3 mt-1 flex items-center justify-center transition-colors" style="border-color: var(--primary-accent);"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M20 6 9 17l-5-5"></path></svg></div><span class="task-text transition-all">Water all plants (basil, greenhouse, porch).</span></li>
                    <li class="flex items-start cursor-pointer task-item group"><div class="check-circle shrink-0 h-5 w-5 rounded-full border-2 mr-3 mt-1 flex items-center justify-center transition-colors" style="border-color: var(--primary-accent);"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M20 6 9 17l-5-5"></path></svg></div><span class="task-text transition-all">Give Lizzie a handful of arugula.</span></li>
                </ul></div></div>
            </div>

            <!-- 3:00 PM -->
            <div class="bg-white rounded-xl shadow-md overflow-hidden border border-gray-200">
                <div class="p-4 sm:p-5 accordion-header cursor-pointer flex justify-between items-center skin-giraffe transition-colors">
                    <div class="flex items-center">
                        <div class="bg-white/70 rounded-lg p-3 mr-4 backdrop-blur-sm"><h2 class="font-bold text-lg sm:text-xl" style="color: var(--highlight-color);">3:00 PM</h2></div>
                        <div><p class="font-semibold">Afternoon Break</p></div>
                    </div>
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-6 w-6 accordion-arrow transition-transform"><path d="m6 9 6 6 6-6"></path></svg>
                </div>
                <div class="task-list"><div class="p-4 sm:p-5 border-t" style="border-color: var(--border-color);"><ul class="space-y-3">
                    <li class="flex items-start cursor-pointer task-item group"><div class="check-circle shrink-0 h-5 w-5 rounded-full border-2 mr-3 mt-1 flex items-center justify-center transition-colors" style="border-color: var(--primary-accent);"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M20 6 9 17l-5-5"></path></svg></div><span class="task-text transition-all">Take Grace out. <b class="font-bold text-red-500">Remember to carry her.</b></span></li>
                </ul></div></div>
            </div>

            <!-- 5:30 PM -->
            <div class="bg-white rounded-xl shadow-md overflow-hidden border border-gray-200">
                <div class="p-4 sm:p-5 accordion-header cursor-pointer flex justify-between items-center skin-zebra transition-colors">
                    <div class="flex items-center">
                        <div class="bg-white/70 rounded-lg p-3 mr-4 backdrop-blur-sm"><h2 class="font-bold text-lg sm:text-xl" style="color: var(--secondary-accent);">5:30 PM</h2></div>
                        <div><p class="font-semibold">Evening Routine</p></div>
                    </div>
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-6 w-6 accordion-arrow transition-transform"><path d="m6 9 6 6 6-6"></path></svg>
                </div>
                <div class="task-list"><div class="p-4 sm:p-5 border-t" style="border-color: var(--border-color);"><ul class="space-y-3">
                    <li class="flex items-start cursor-pointer task-item group"><div class="check-circle shrink-0 h-5 w-5 rounded-full border-2 mr-3 mt-1 flex items-center justify-center transition-colors" style="border-color: var(--primary-accent);"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M20 6 9 17l-5-5"></path></svg></div><span class="task-text transition-all">Feed the little girls their dinner.</span></li>
                    <li class="flex items-start cursor-pointer task-item group"><div class="check-circle shrink-0 h-5 w-5 rounded-full border-2 mr-3 mt-1 flex items-center justify-center transition-colors" style="border-color: var(--primary-accent);"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M20 6 9 17l-5-5"></path></svg></div><span class="task-text transition-all"><b class="font-bold text-orange-600">Critical:</b> Watch Zoe eat so Nellie doesn’t steal her food.</span></li>
                </ul></div></div>
            </div>

            <!-- 10:00 PM -->
            <div class="bg-white rounded-xl shadow-md overflow-hidden border border-gray-200">
                <div class="p-4 sm:p-5 accordion-header cursor-pointer flex justify-between items-center skin-dots transition-colors">
                    <div class="flex items-center">
                        <div class="bg-white/70 rounded-lg p-3 mr-4 backdrop-blur-sm"><h2 class="font-bold text-lg sm:text-xl" style="color: #6a5acd;">10:00 PM</h2></div>
                        <div><p class="font-semibold">Bedtime Routine</p></div>
                    </div>
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-6 w-6 accordion-arrow transition-transform"><path d="m6 9 6 6 6-6"></path></svg>
                </div>
                <div class="task-list"><div class="p-4 sm:p-5 border-t" style="border-color: var(--border-color);"><ul class="space-y-3">
                    <li class="flex items-start cursor-pointer task-item group"><div class="check-circle shrink-0 h-5 w-5 rounded-full border-2 mr-3 mt-1 flex items-center justify-center transition-colors" style="border-color: var(--primary-accent);"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M20 6 9 17l-5-5"></path></svg></div><span class="task-text transition-all">Ask "Do you want a cookie?" to get everyone to bed.</span></li>
                    <li class="flex items-start cursor-pointer task-item group"><div class="check-circle shrink-0 h-5 w-5 rounded-full border-2 mr-3 mt-1 flex items-center justify-center transition-colors" style="border-color: var(--primary-accent);"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M20 6 9 17l-5-5"></path></svg></div><span class="task-text transition-all">Little girls get half a cookie (from closet).</span></li>
                    <li class="flex items-start cursor-pointer task-item group"><div class="check-circle shrink-0 h-5 w-5 rounded-full border-2 mr-3 mt-1 flex items-center justify-center transition-colors" style="border-color: var(--primary-accent);"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M20 6 9 17l-5-5"></path></svg></div><span class="task-text transition-all">Big girls get a whole cookie PLUS one Propectalin tablet.</span></li>
                </ul></div></div>
            </div>

            <!-- Reminders -->
            <div class="mt-8">
                <div class="bg-yellow-100/50 border-l-4 border-yellow-400 text-yellow-800 p-4 rounded-r-lg">
                    <h3 class="font-bold flex items-center mb-2">Tonight Only: Garbage Day</h3>
                    <p class="text-sm">Take out the garbage with the cardboard.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- AI Modal -->
    <div id="ai-modal" class="modal fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 opacity-0 pointer-events-none">
        <div id="modal-content" class="modal-content bg-white rounded-2xl shadow-2xl p-6 sm:p-8 max-w-lg w-full transform scale-95">
            <div class="flex justify-between items-center mb-4">
                <h3 class="title-font text-2xl" style="color: var(--primary-accent);">Pawsitive Report</h3>
                <button id="close-modal" class="text-gray-400 hover:text-gray-600">&times;</button>
            </div>
            <div id="ai-response" class="space-y-4 text-lg" style="color: var(--text-color);">
                <!-- Loading spinner -->
                <div id="loading-spinner" class="text-center py-8">
                    <svg class="animate-spin h-10 w-10 mx-auto" style="color: var(--primary-accent);" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                    <p class="mt-4 text-sm">Generating your report...</p>
                </div>
            </div>
        </div>
    </div>

    <script src="config.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // --- Accordion Functionality ---
            const accordionHeaders = document.querySelectorAll('.accordion-header');
            accordionHeaders.forEach(header => {
                header.addEventListener('click', () => {
                    const taskList = header.nextElementSibling;
                    const arrow = header.querySelector('.accordion-arrow');
                    taskList.classList.toggle('expanded');
                    arrow.classList.toggle('rotate-180');
                });
            });

            // --- Task Completion Functionality ---
            const taskItems = document.querySelectorAll('.task-item');
            taskItems.forEach(item => {
                item.addEventListener('click', (e) => {
                    e.stopPropagation();
                    item.classList.toggle('completed');
                });
            });

            // --- Auto-expand the first section on load ---
            const firstHeader = document.querySelector('.accordion-header');
            if(firstHeader) {
                firstHeader.click();
            }

            // --- AI Modal Functionality ---
            const aiButton = document.getElementById('ai-button');
            const aiModal = document.getElementById('ai-modal');
            const modalContent = document.getElementById('modal-content');
            const closeModalButton = document.getElementById('close-modal');
            const aiResponseContainer = document.getElementById('ai-response');
            const loadingSpinner = document.getElementById('loading-spinner');

            function openModal() {
                aiModal.classList.remove('opacity-0', 'pointer-events-none');
                modalContent.classList.remove('scale-95');
            }

            function closeModal() {
                aiModal.classList.add('opacity-0', 'pointer-events-none');
                modalContent.classList.add('scale-95');
            }

            closeModalButton.addEventListener('click', closeModal);
            aiModal.addEventListener('click', (e) => {
                if (e.target === aiModal) {
                    closeModal();
                }
            });

            aiButton.addEventListener('click', async () => {
                openModal();
                loadingSpinner.style.display = 'block';
                aiResponseContainer.innerHTML = ''; // Clear previous content
                aiResponseContainer.appendChild(loadingSpinner);

                // 1. Collect task data
                let completedTasks = [];
                let pendingTasks = [];
                document.querySelectorAll('.task-item').forEach(task => {
                    const text = task.querySelector('.task-text').innerText;
                    if (task.classList.contains('completed')) {
                        completedTasks.push(text);
                    } else {
                        pendingTasks.push(text);
                    }
                });

                // 2. Construct the prompt
                const prompt = `
                    You are a cheerful, encouraging, and slightly whimsical "Pawsitive Assistant" for a dog owner.
                    Your personality is warm, feminine, and you love using dog-related puns.
                    Based on the following task list, provide a short, uplifting summary of the day's progress.
                    Make sure to mention some of the dogs by name (Gracey, Macy P, Zoe, Nellie, Lizzie).
                    Keep the tone light and celebratory.

                    Here is the status of today's tasks:
                    - Tasks Completed: ${completedTasks.length > 0 ? completedTasks.join(', ') : 'None yet!'}
                    - Tasks Remaining: ${pendingTasks.length > 0 ? pendingTasks.join(', ') : 'None, all done!'}

                    Generate a "Pawsitive Report" based on this information.
                `;

                // 3. Call Gemini API
                try {
                    let chatHistory = [{ role: "user", parts: [{ text: prompt }] }];
                    const payload = { contents: chatHistory };
                    const apiKey = API_KEY; // API key will be injected by the environment
                    const apiUrl = \`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=\${apiKey}\`;

                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) {
                        throw new Error(\`API request failed with status \${response.status}\`);
                    }

                    const result = await response.json();

                    let text = "Sorry, I couldn't retrieve the report. Please try again!";
                    if (result.candidates && result.candidates.length > 0 && result.candidates[0].content && result.candidates[0].content.parts && result.candidates[0].content.parts.length > 0) {
                        text = result.candidates[0].content.parts[0].text;
                    }

                    loadingSpinner.style.display = 'none';
                    // Simple markdown to HTML
                    text = text.replace(/\\*\\*([^*]+)\\*\\*/g, '<strong>$1</strong>').replace(/\\n/g, '<br>');
                    aiResponseContainer.innerHTML = \`<p>\${text}</p>\`;

                } catch (error) {
                    console.error("Error fetching AI response:", error);
                    loadingSpinner.style.display = 'none';
                    aiResponseContainer.innerHTML = '<p>Oh no! There was a little hiccup fetching your report. Please check the connection and try again.</p>';
                }
            });
        });
    </script>
</body>
</html>